<!doctype html>
<html>
<head>
    <title>ForeFlight Logbook Summary</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

    <h1>ForeFlight Logbook Summary</h1>

    <!-- File Upload Form -->
    <form action="/" method="post" enctype="multipart/form-data">
        <input type="file" name="file" accept=".csv" required>
        <button type="submit">Upload</button>
    </form>

    {% if summary %}
        <h2>Summary Information</h2>
        <p>First Flight: {{ summary.first_flight.strftime('%Y-%m-%d') }}</p>
        <p>Most Recent Flight: {{ summary.last_flight.strftime('%Y-%m-%d') }}</p>

        <h3>Flights by Tail Number</h3>
        <table>
            <tr><th>Tail Number</th><th>Flights</th></tr>
            {% for _, row in summary.tail_number_counts.iterrows() %}
            <tr class="{{ 'popular' if row['Tail Number'] == summary.most_popular_aircraft else '' }}">
                <td>{{ row['Tail Number'] }}</td>
                <td>{{ row['Flights'] }}</td>
            </tr>
            {% endfor %}
        </table>

        <h2>Flights Log (Running Totals)</h2>
        <table>
            <tr>
                <th>Date</th><th>AircraftID</th><th>Total Time</th><th>PIC</th><th>Night</th>
                <th>Running Total Time</th><th>Running Day Time</th><th>Running Night</th>
                <th>Running Sim Inst</th><th>Running Ground Training</th>
                <th>Running Dual Received</th><th>Running PIC</th><th>Running Landings</th>
            </tr>
            {% for flight in flights %}
            <tr class="{{ flight.highlight }}">
                <td>{{ flight.Date }}</td><td>{{ flight.AircraftID }}</td><td>{{ flight.TotalTime }}</td>
                <td>{{ flight.PIC }}</td><td>{{ flight.Night }}</td><td>{{ flight.RunningTotalTime }}</td>
                <td>{{ flight.RunningDayTime }}</td><td>{{ flight.RunningNight }}</td><td>{{ flight.RunningSimulatedInstrument }}</td>
                <td>{{ flight.RunningGroundTraining }}</td><td>{{ flight.RunningDualReceived }}</td><td>{{ flight.RunningPIC }}</td>
                <td>{{ flight.RunningLandings }}</td>
            </tr>
            {% endfor %}
        </table>
    {% endif %}

</body>
</html>
