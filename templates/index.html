<!doctype html>
<html>
<head>
    <title>ForeFlight Logbook Summary</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <h1>ForeFlight Logbook Summary</h1>

    <h2>Summary Information</h2>
    <p>First Flight: {{ summary.first_flight.strftime('%Y-%m-%d') }}</p>
    <p>Most Recent Flight: {{ summary.last_flight.strftime('%Y-%m-%d') }}</p>

    <h3>Flights by Tail Number</h3>
    <table>
        <tr><th>Tail Number</th><th>Flights</th></tr>
        {% for _, row in summary.tail_number_counts.iterrows() %}
        <tr class="{{ 'popular' if row['Tail Number'] == most_popular_aircraft else '' }}">
            <td>{{ row['Tail Number'] }}</td>
            <td>{{ row['Flights'] }}</td>
        </tr>
        {% endfor %}
    </table>

    <p>Solo Hours (Last 30 Days): {{ "%.1f"|format(summary.solo_hours_last_30) }}</p>
    <p>Dual Hours (Last 30 Days): {{ "%.1f"|format(summary.dual_hours_last_30) }}</p>

    <h2>Flight Log (Running Totals)</h2>
    <table>
        <tr>
            <th>Date</th><th>AircraftID</th><th>From</th><th>To</th><th>Total Time</th>
            <th>Dual Rec</th><th>Night</th><th>Sim Inst</th><th>PIC</th>
            <th>Day Landings</th><th>Night Landings</th>
        </tr>
        {% for flight in flights %}
        <tr class="{{ 'anomaly' if flight.is_anomaly else '' }}">
            <td>{{ flight.Date }}</td><td>{{ flight.AircraftID }}</td><td>{{ flight.From }}</td>
            <td>{{ flight.To }}</td><td>{{ flight.TotalTime }}</td><td>{{ flight.DualReceived }}</td>
            <td>{{ flight.Night }}</td><td>{{ flight.SimulatedInstrument }}</td><td>{{ flight.PIC }}</td>
            <td>{{ flight.DayLandingsFullStop }}</td><td>{{ flight.NightLandingsFullStop }}</td>
        </tr>
        {% endfor %}
    </table>

    <h2>Field Fill Rates</h2>
    <table>
        <tr><th>Field</th><th>Fill Rate (%)</th></tr>
        {% for field, rate in fill_rates.items() %}
        <tr><td>{{ field }}</td><td>{{ "%.1f"|format(rate) }}%</td></tr>
        {% endfor %}
    </table>
</body>
</html>
